import{K as V,X as $,r as t,j as e,Y as B,P as F,L as g,T as n,Z as R,_ as C,N as S,$ as A,a0 as z,O as c,a1 as M,a2 as T}from"./index-C6GUv-sR.js";import{u as D,C as i,o as H,c as U,a as l,b as Y}from"./index.esm-I9PFDQqp.js";import{T as d}from"./TextField-Cq6ATHaf.js";import{I as W}from"./InputAdornment-Bjp0fACK.js";import{V as I,G as J,L as K}from"./VisibilityOff-0c_pt8A0.js";import{V as k}from"./Visibility-B_2DgsVW.js";const X=U().shape({name:l().min(2,"Name must be at least 2 characters").required("Name is required"),email:l().email("Invalid email").required("Email is required"),password:l().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:l().oneOf([Y("password")],"Passwords must match").required("Confirm password is required"),phone:l().matches(/^\+?\d{10,15}$/,"Invalid phone number").optional()}),oe=()=>{const u=V(),{setUser:f,setToken:j}=$(),[p,E]=t.useState(!1),[h,L]=t.useState(!1),[y,m]=t.useState(null),[w,b]=t.useState(!1),[x,P]=t.useState(!1),{control:o,handleSubmit:q,formState:{errors:a}}=D({resolver:H(X),defaultValues:{name:"",email:"",password:"",confirmPassword:"",phone:""}}),G=async s=>{b(!0),m(null);try{const r=T(),{confirmPassword:Z,...N}=s,v=await r.signup(N);f(v.user),j(v.token),s.phone?u(c.VERIFY,{state:{phone:s.phone}}):u(c.HOME)}catch(r){m(r.message||"Sign up failed. Please try again.")}finally{b(!1)}},O=async()=>{P(!0),m(null);try{const r=await T().loginWithGoogle();f(r.user),j(r.token),u(c.HOME)}catch(s){m(s.message||"Google sign up failed. Please try again.")}finally{P(!1)}};return e.jsx(B,{maxWidth:"sm",sx:{mt:4,mb:4},children:e.jsxs(F,{elevation:3,sx:{p:4,borderRadius:3},children:[e.jsxs(g,{textAlign:"center",mb:4,children:[e.jsx(n,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Join Mera Local Market"}),e.jsx(n,{variant:"body1",color:"text.secondary",children:"Create your account to start buying and selling"})]}),y&&e.jsx(R,{severity:"error",sx:{mb:3},children:y}),e.jsxs("form",{onSubmit:q(G),children:[e.jsx(i,{name:"name",control:o,render:({field:s})=>{var r;return e.jsx(d,{...s,fullWidth:!0,label:"Full Name",margin:"normal",error:!!a.name,helperText:(r=a.name)==null?void 0:r.message,autoComplete:"name",autoFocus:!0})}}),e.jsx(i,{name:"email",control:o,render:({field:s})=>{var r;return e.jsx(d,{...s,fullWidth:!0,label:"Email Address",type:"email",margin:"normal",error:!!a.email,helperText:(r=a.email)==null?void 0:r.message,autoComplete:"email"})}}),e.jsx(i,{name:"phone",control:o,render:({field:s})=>{var r;return e.jsx(d,{...s,fullWidth:!0,label:"Phone Number (Optional)",margin:"normal",error:!!a.phone,helperText:((r=a.phone)==null?void 0:r.message)||"We'll send a verification code if provided",autoComplete:"tel",placeholder:"+91 9876543210"})}}),e.jsx(i,{name:"password",control:o,render:({field:s})=>{var r;return e.jsx(d,{...s,fullWidth:!0,label:"Password",type:p?"text":"password",margin:"normal",error:!!a.password,helperText:(r=a.password)==null?void 0:r.message,autoComplete:"new-password",InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(C,{onClick:()=>E(!p),edge:"end",children:p?e.jsx(I,{}):e.jsx(k,{})})})}})}}),e.jsx(i,{name:"confirmPassword",control:o,render:({field:s})=>{var r;return e.jsx(d,{...s,fullWidth:!0,label:"Confirm Password",type:h?"text":"password",margin:"normal",error:!!a.confirmPassword,helperText:(r=a.confirmPassword)==null?void 0:r.message,autoComplete:"new-password",InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(C,{onClick:()=>L(!h),edge:"end",children:h?e.jsx(I,{}):e.jsx(k,{})})})}})}}),e.jsx(S,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:w,sx:{mt:3,mb:2,py:1.5},children:w?e.jsx(A,{size:24}):"Create Account"})]}),e.jsx(z,{sx:{my:3},children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"or"})}),e.jsx(S,{fullWidth:!0,variant:"outlined",size:"large",startIcon:x?e.jsx(A,{size:20}):e.jsx(J,{}),onClick:O,disabled:x,sx:{mb:3,py:1.5},children:x?"Creating account...":"Continue with Google"}),e.jsx(g,{textAlign:"center",children:e.jsxs(n,{variant:"body2",color:"text.secondary",children:["Already have an account?"," ",e.jsx(K,{component:M,to:c.LOGIN,underline:"hover",children:"Sign in here"})]})}),e.jsx(g,{sx:{mt:3,p:2,bgcolor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.300"},children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"By creating an account, you agree to our Terms of Service and Privacy Policy."})})]})})};export{oe as default};
